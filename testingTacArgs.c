#include <stdio.h>
#include <unistd.h>

//Assemlbly comments in NASM syntax.
char *shellcode="\x31\xc0" //xor eax,eax
"\x50" //push eax
"\x68\x6e\x2f\x6c\x73" //push 'n/ls'
"\x68\x2f\x2f\x62\x69" //push '//bi'
"\x89\xe3" //mov ebx,esp
"\x50" //push eax
"\x50" //push eax
"\x53" //push ebx
"\x89\xe1" //mov ecx,esp
"\x50" //push eax
"\x68\x2d\x41\x6c\x61"
"\x89\xe2" //mov edx,esp
"\x89\x51\x4" //mov [ecx+4],edx
"\x50" //push eax
"\x89\xe2" //mov edx,esp
"\xb0\x0b" //mov al,11
"\xcd\x80"; //int $0x80

int main(){
    int (*ret)() = (int(*)())shellcode;
    ret();
}
